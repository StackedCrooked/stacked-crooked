<html>
<head>
    <style type="text/css">


        textarea {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .input {;
            position: relative;
            height: 60%;
            margin-bottom: 5px
        }

        .output {
            height: 30%;
            margin-bottom: 5px;
        }

        .commit {
            text-align: right;
        }

    </style>
    <script type="text/javascript">


        var app = {};


        app.alert = function (msg) {
            console.log(msg);
        };

        app.input = document.getElementById("input");
        app.inputMargin = 10;


        app.send = function (title, payload) {
            app.alert('app.send');
            var httpRequest = new XMLHttpRequest();
            httpRequest.open("PUT", "http://localhost:4000/" + title, false);
            httpRequest.send(payload);

            httpRequest.onreadystatechange = function () {
                if (httpRequest.readyState == 4) {
                    if (httpRequest.status == 200) {
                        app.alert('HTTP STATUS 200');
                        app.alert(JSON.stringify(httpRequest));
                        app.onReply(httpRequest.responseText);
                    } else {
                        app.alert("HTTP STATUS " + httpRequest.status);
                    }
                } else {
                    app.alert("HTTP STATUS " + httpRequest.status);
                    app.alert("httpRequest.readyState: " + httpRequest.readyState);
                }
            };
        };

        window.onload = function () {
            app.alert("window.onload");
            app.input = document.getElementById("input");
            app.output = document.getElementById("outputText");
            app.commit = document.getElementById("compileButton");
            app.input.style = { left:50, right:50, width:200 };
            app.enterTimeoutLoop();
        };


        app.enterTimeoutLoop = function () {
            app.alert("app.enterTimeoutLoop");
            window.setTimeout(app.enterTimeoutLoop, 2000);
        };


        app.onCompile = function () {
            app.alert('app.onCompile');
            var compileButton = document.getElementById('TextArea');
            alert("compile: " + compileButton.textContent);
            app.send("compile", compileButton.textContent);
        };

        app.onReply = function (reply) {
            app.alert(reply);
            app.alert(JSON.parse(reply));
            var obj = JSON.parse(reply);
        };


    </script>
</head>
<body>


<div class="input">
    <label for="input"></label><textarea id="input">Hello! </textarea>
</div>
<div class="output"><label for="output"></label><textarea id="output">You fool!</textarea>
</div>
<div class=commit>
    <button id="commit">Compile!</button>
</div>


</body>
</html>
