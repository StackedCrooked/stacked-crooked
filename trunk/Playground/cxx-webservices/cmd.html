<html>
<head>
<style type="text/css">

    .cpp {
        position: relative;
        width: 100%;
    }

    #input   { height: 70% }
    #output  { height: 20% }
    #submit  { height: 10% }



</style>
<script type="text/javascript">


        var app = {};


        app.log = function (msg) {
            console.log(msg);
        };

        app.input = document.getElementById("input");
        app.inputMargin = 10;


        app.send = function (title, payload) {
            app.log('app.send');
            var httpRequest = new XMLHttpRequest();
            httpRequest.open("PUT", "http://localhost:4000/" + title, false);
            httpRequest.send(payload);

            httpRequest.onreadystatechange = function () {
                if (httpRequest.readyState == 4) {
                    if (httpRequest.status == 200) {
                        app.log('HTTP STATUS 200');
                        app.log(JSON.stringify(httpRequest));
                        app.onReply(httpRequest.responseText);
                    } else {
                        app.log("HTTP STATUS " + httpRequest.status);
                    }
                } else {
                    app.log("HTTP STATUS " + httpRequest.status);
                    app.log("httpRequest.readyState: " + httpRequest.readyState);
                }
            };
        };

        window.onload = function () {
            app.log("window.onload");
            app.input = document.getElementById("input");
            app.output = document.getElementById("output");
            app.commit = document.getElementById("commit");
            app.enterTimeoutLoop();
        };


        app.enterTimeoutLoop = function () {
            window.setTimeout(app.enterTimeoutLoop, 500);
        };


        app.onCompile = function () {
            app.log('app.onCompile');
            var commit = document.getElementById('TextArea');
            alert("compile: " + commit.textContent);
            app.send("compile", commit.textContent);
        };

        app.onReply = function (reply) {
            app.log(reply);
            app.log(JSON.parse(reply));
            var obj = JSON.parse(reply);
        };


    </script>
</head>
<body>

<span class="input_span" class="cpp">
    <label for="input"></label>
    <textarea id="input" class="cpp"></textarea>
</span>


<span class="output_span" class="cpp">
    <label for="output"></label>
    <textarea id="output" class="cpp"></textarea>
</span>


<button id="submit" class="cpp">Submit!</button>


</body>
</html>
