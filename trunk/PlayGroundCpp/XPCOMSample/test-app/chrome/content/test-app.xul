<?xml version="1.0"?>
<?xml-stylesheet href="chrome://navigator/skin/navigator.css" type="text/css"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<window id="testWindow"
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
    title="XPCOM Test application"
    orient="vertical"
    align="stretch"
    screenX="240"
    screenY="120"
    width="640"
    height="480">

    <script type="application/x-javascript">
        <![CDATA[
        var TestApp = {};
        TestApp.initialize = function() {
            netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
            var cid = "@stacked-crooked.com/XPCOMSample/CrookedComponent;1";
            if (!TestApp.isComponentRegistered(cid))
            {
                alert("Component " + cid + " is not registered.");
            }
            else
            {
                alert("Component has been successfully registered!");
            }
            TestApp.listRegisteredClasses();
        };

        TestApp.listRegisteredClasses = function() {
          var properties = "";
          for (var key in Components.classes) {
            var className = Components.classes[key];
            properties += className;
            properties += "\n";
          }
          document.getElementById("classesTextBox").setAttribute("value", properties);
        };

        TestApp.isComponentRegistered = function(inComponentId) {
          return typeof(Components.classes[inComponentId]) !== 'undefined';
        };

        window.addEventListener("load", function() {
            try {
              TestApp.initialize();
            }
            catch (err) {
              alert(err);
            }
          },
          false);
        ]]>
    </script>
    <groupbox flex="1">
        <caption label="Registered classes" />
        <textbox id="classesTextBox" multiline="true" readonly="true" flex="1" />
    </groupbox>
</window>

